import{B as tt,k as B,r,z as et,c as d,o as i,a as A,u as K,m as lt,w as E,d as t,e as g,n as h,g as ot,i as P,j as n,y,P as H,v as T,F,f as q,t as u,h as L,x as p,s as U,W as at}from"./app-CmYmw4sZ.js";import{_ as st}from"./AuthenticatedLayout-DJ1yYA2u.js";import{_ as nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const it={class:"flex min-h-screen bg-gray-100"},ut={class:"flex-1 md:ml-24 w-full overflow-x-hidden"},rt={class:"flex items-center justify-between bg-white p-4 shadow md:hidden safe-area-inset-top"},dt={class:"py-12"},vt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},pt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6 text-gray-900"},mt={class:"stock-management"},gt={class:"header"},kt={class:"actions"},ft={class:"showing"},bt={class:"product-table"},ct={width:"30"},yt={key:0},xt=["onUpdate:modelValue"],wt=["value","onChange"],St=["onClick"],Pt={key:0,class:"action-menu"},Ct=["onClick","title"],Mt={class:"pagination"},Vt={class:"pagination-info"},Bt={class:"pagination-controls"},ht=["disabled"],Ut=["onClick"],Dt=["disabled"],Nt={key:0,class:"modal"},$t={class:"modal-content"},It={class:"modal-header"},Rt={class:"modal-body"},At={class:"import-instructions"},Kt={class:"file-upload"},Et={key:0},Ft={class:"modal-footer"},Lt=["disabled"],jt={key:1,class:"modal"},Ht={class:"modal-content"},Tt={class:"modal-header"},qt={class:"modal-body"},Ot={class:"form-group"},zt={class:"form-group"},Gt={class:"form-group"},Jt={class:"form-group"},Wt={class:"form-group"},Qt={class:"form-group"},Xt={class:"modal-footer"},Yt={class:"form-group"},Zt={key:2,class:"modal"},_t={class:"modal-content"},te={class:"modal-header"},ee={class:"modal-body"},le={class:"form-group"},oe={class:"form-group"},ae={class:"form-group"},se={class:"form-group"},ne={class:"form-group"},ie={class:"form-group"},ue={class:"form-group"},re={class:"modal-footer"},de={__name:"StockManagement",props:{products:{type:Array,default:()=>[]},addProductRoute:{type:String,required:!0},listProductsRoute:{type:String,required:!0}},setup(D){const j=D,O=tt(),C=B(()=>O.props.auth.user.role_id===2),b=r(j.products||[]),x=r(5),v=r(1),N=r(!1),k=r(null),$=r(!1),M=r(!1),I=r(null),w=r(!1),S=r(!1),s=r({id:"",code:"",name:"",stock:0,average_price:0,selling_price:0,category:"",unit:""}),a=r({id:"",name:"",stock:0,average_price:0,markup:0,selling_price:0,category:"",unit:"",status:"Avail",selected:!1}),V=async()=>{try{const o=await U.get(j.listProductsRoute);o.data&&o.data.products&&(b.value=o.data.products.map(e=>({...e,selected:!1,status:e.stock>0?"Avail":"Out of Stock"})))}catch(o){console.error("Error fetching products:",o),b.value=[]}},c=B(()=>Math.ceil(b.value.length/x.value)),z=B(()=>{const o=(v.value-1)*x.value,e=o+x.value;return b.value.slice(o,e)}),G=B(()=>{const o=[];if(c.value<=5)for(let l=1;l<=c.value;l++)o.push(l);else{let l=Math.max(1,v.value-2),f=Math.min(c.value,l+5-1);f-l<4&&(l=Math.max(1,f-5+1));for(let m=l;m<=f;m++)o.push(m)}return o}),J=()=>{b.value.forEach(o=>{o.selected=N.value})},W=o=>{k.value=k.value===o?null:o},R=o=>{o>=1&&o<=c.value&&(v.value=o,k.value=null)},Q=o=>{if(!C.value){alert("Hanya owner yang dapat mengedit produk");return}s.value={...o},S.value=!0,k.value=null},X=async()=>{if(!a.value.name||!a.value.category){alert("Nama dan Kategori produk harus diisi!");return}try{await U.post("/api/products",a.value),await V(),M.value=!1,a.value={id:"",name:"",stock:0,average_price:0,markup:0,selling_price:0,category:"",unit:"",status:"Avail",selected:!1}}catch(o){console.error("Error creating product:",o)}},Y=async()=>{try{(await U.put(`/api/products/${s.value.id}`,s.value)).status===200&&(await V(),S.value=!1)}catch(o){console.error("Error updating product:",o),alert("Gagal mengupdate produk")}},Z=async o=>{try{await U.patch(`/api/products/${o.id}/toggle-status`),o.is_active=!o.is_active,await V()}catch(e){console.error("Error toggling product status:",e),alert("Gagal mengubah status produk")}},_=()=>{at.post(route("logout"))};return et(()=>{V(),document.addEventListener("click",o=>{!o.target.closest(".action-button")&&k.value!==null&&(k.value=null)})}),(o,e)=>(i(),d(F,null,[A(K(lt),{title:"Stock Management"}),A(st,null,{default:E(()=>[t("div",it,[t("aside",{class:h(["bg-white shadow-lg flex flex-col items-center pt-6 fixed inset-y-0 left-0 transition-transform z-30",w.value?"translate-x-0":"-translate-x-full","md:translate-x-0 md:static md:w-24 w-64","safe-area-inset-left"])},[e[33]||(e[33]=t("nav",{class:"flex flex-col items-center gap-10 mt-8 flex-1"},[t("a",{href:"/dashboard",class:"flex flex-col items-center"},[t("div",{class:"p-3 rounded-md text-gray-500"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h7"})])]),t("span",{class:"text-xs mt-2"},"Dashboard")]),t("a",{href:"/stock-management",class:"flex flex-col items-center"},[t("div",{class:"p-3 rounded-md bg-purple-100 text-purple-700"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})])]),t("span",{class:"text-xs mt-2"},"Stock Barang")])],-1)),t("button",{onClick:_,class:"flex flex-col items-center mt-auto mb-6"},e[32]||(e[32]=[t("div",{class:"p-3 rounded-md"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})])],-1),t("span",{class:"text-xs mt-2"},"Logout",-1)]))],2),w.value?(i(),d("div",{key:0,onClick:e[0]||(e[0]=l=>w.value=!1),class:"fixed inset-0 bg-black bg-opacity-50 z-20 md:hidden"})):g("",!0),t("div",ut,[t("header",rt,[t("button",{onClick:e[1]||(e[1]=l=>w.value=!w.value),class:"p-2 -m-2"},e[34]||(e[34]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])),e[35]||(e[35]=t("h1",{class:"text-lg font-semibold"},"Stock Management",-1)),e[36]||(e[36]=t("div",{class:"w-8 h-8 rounded-full bg-gray-300"},null,-1))]),t("div",dt,[t("div",vt,[t("div",pt,[t("div",mt,[t("div",gt,[e[42]||(e[42]=t("h2",{class:"title"},"Product",-1)),t("div",kt,[t("div",ft,[e[38]||(e[38]=P(" Showing ")),n(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>x.value=l),class:"page-select"},e[37]||(e[37]=[t("option",{value:2},"2",-1),t("option",{value:5},"5",-1),t("option",{value:10},"10",-1),t("option",{value:25},"25",-1),t("option",{value:50},"50",-1)]),512),[[y,x.value]])]),e[41]||(e[41]=t("button",{class:"btn-filter"},[t("i",{class:"fas fa-filter"}),P(" Filter ")],-1)),D.addProductRoute?(i(),ot(K(H),{key:0,href:D.addProductRoute,class:"btn-add"},{default:E(()=>e[39]||(e[39]=[P(" Tambah Produk ")])),_:1},8,["href"])):g("",!0),A(K(H),{href:o.route("employee.stock.history"),class:"btn-view"},{default:E(()=>e[40]||(e[40]=[P(" Riwayat Stok ")])),_:1},8,["href"])])]),t("div",bt,[t("table",null,[t("thead",null,[t("tr",null,[t("th",ct,[n(t("input",{type:"checkbox",onChange:J,"onUpdate:modelValue":e[3]||(e[3]=l=>N.value=l)},null,544),[[T,N.value]])]),e[43]||(e[43]=t("th",null,"ID Barang",-1)),e[44]||(e[44]=t("th",null,"Nama Barang",-1)),e[45]||(e[45]=t("th",null,"Stock",-1)),e[46]||(e[46]=t("th",null,"Harga Rata-rata",-1)),e[47]||(e[47]=t("th",null,"Keuntungan/Produk",-1)),e[48]||(e[48]=t("th",null,"Harga Jual",-1)),e[49]||(e[49]=t("th",null,"Category",-1)),e[50]||(e[50]=t("th",null,"Unit",-1)),e[51]||(e[51]=t("th",null,"Status",-1)),e[52]||(e[52]=t("th",null,null,-1))])]),t("tbody",null,[b.value.length===0?(i(),d("tr",yt,e[53]||(e[53]=[t("td",{colspan:"12",class:"py-4 px-4 border-b text-center"}," Tidak ada produk tersedia ",-1)]))):g("",!0),(i(!0),d(F,null,q(z.value,(l,f)=>(i(),d("tr",{key:l.id},[t("td",null,[n(t("input",{type:"checkbox","onUpdate:modelValue":m=>l.selected=m},null,8,xt),[[T,l.selected]])]),t("td",null,u(l.code),1),t("td",null,u(l.name),1),t("td",null,u(l.stock),1),t("td",null,"Rp "+u(Number(l.average_price).toLocaleString()),1),t("td",null,"Rp "+u(Number(l.profit).toLocaleString()),1),t("td",null,"Rp "+u(Number(l.selling_price).toLocaleString()),1),t("td",null,u(l.category||"-"),1),t("td",null,u(l.unit||"-"),1),t("td",null,[t("select",{value:l.is_active?"active":"inactive",onChange:m=>Z(l),class:h(["px-3 py-1 rounded text-sm font-medium border",{"bg-green-100 text-green-600":l.is_active,"bg-red-100 text-red-600":!l.is_active}])},e[54]||(e[54]=[t("option",{value:"active"},"Aktif",-1),t("option",{value:"inactive"},"Nonaktif",-1)]),42,wt)]),t("td",null,[t("button",{class:"action-button",onClick:m=>W(f)},e[55]||(e[55]=[t("i",{class:"fas fa-ellipsis-h"},null,-1)]),8,St),k.value===f?(i(),d("div",Pt,[t("button",{onClick:m=>Q(l),class:h({disabled:!C.value}),title:C.value?"":"Hanya owner yang dapat mengedit produk"},u(C.value?"Edit":"Edit (Owner Only)"),11,Ct)])):g("",!0)])]))),128))])])]),t("div",Mt,[t("div",Vt,u(v.value)+" of "+u(c.value),1),t("div",Bt,[t("button",{onClick:e[4]||(e[4]=l=>R(v.value-1)),disabled:v.value===1},e[56]||(e[56]=[t("i",{class:"fas fa-chevron-left"},null,-1)]),8,ht),(i(!0),d(F,null,q(G.value,l=>(i(),d("button",{key:l,onClick:f=>R(l),class:h({active:v.value===l})},u(l),11,Ut))),128)),t("button",{onClick:e[5]||(e[5]=l=>R(v.value+1)),disabled:v.value===c.value},e[57]||(e[57]=[t("i",{class:"fas fa-chevron-right"},null,-1)]),8,Dt)])]),$.value?(i(),d("div",Nt,[t("div",$t,[t("div",It,[e[58]||(e[58]=t("h3",null,"Import Data Produk",-1)),t("button",{class:"close-btn",onClick:e[6]||(e[6]=l=>$.value=!1)},"Ã—")]),t("div",Rt,[t("div",At,[e[60]||(e[60]=t("p",null,"Silahkan upload file Excel (.xlsx) atau CSV untuk mengimpor data produk.",-1)),t("p",null,[e[59]||(e[59]=P("Download template: ")),t("a",{href:"#",onClick:e[7]||(e[7]=L((...l)=>o.downloadTemplate&&o.downloadTemplate(...l),["prevent"]))},"template-import-produk.xlsx")])]),t("div",Kt,[t("input",{type:"file",id:"fileInput",onChange:e[8]||(e[8]=(...l)=>o.handleFileChange&&o.handleFileChange(...l)),accept:".xlsx,.xls,.csv"},null,32),t("div",{class:"upload-zone",onClick:e[9]||(e[9]=(...l)=>o.triggerFileInput&&o.triggerFileInput(...l)),onDragover:e[10]||(e[10]=L(()=>{},["prevent"])),onDrop:e[11]||(e[11]=L((...l)=>o.handleFileDrop&&o.handleFileDrop(...l),["prevent"]))},[e[61]||(e[61]=t("i",{class:"fas fa-cloud-upload-alt"},null,-1)),e[62]||(e[62]=t("p",null,"Drag and drop file atau klik untuk memilih",-1)),I.value?(i(),d("span",Et,"File terpilih: "+u(I.value.name),1)):g("",!0)],32)])]),t("div",Ft,[t("button",{class:"btn-cancel",onClick:e[12]||(e[12]=l=>$.value=!1)},"Batal"),t("button",{class:"btn-import",onClick:e[13]||(e[13]=(...l)=>o.importData&&o.importData(...l)),disabled:!I.value},"Import",8,Lt)])])])):g("",!0),M.value?(i(),d("div",jt,[t("div",Ht,[t("div",Tt,[e[63]||(e[63]=t("h3",null,"Tambah Produk Baru",-1)),t("button",{class:"close-btn",onClick:e[14]||(e[14]=l=>M.value=!1)},"Ã—")]),t("div",qt,[t("div",Ot,[e[64]||(e[64]=t("label",{for:"productId"},"ID Barang",-1)),n(t("input",{type:"text",id:"productId","onUpdate:modelValue":e[15]||(e[15]=l=>a.value.id=l),placeholder:"ID Barang"},null,512),[[p,a.value.id]])]),t("div",zt,[e[65]||(e[65]=t("label",{for:"productName"},"Nama Barang",-1)),n(t("input",{type:"text",id:"productName","onUpdate:modelValue":e[16]||(e[16]=l=>a.value.name=l),placeholder:"Nama Barang"},null,512),[[p,a.value.name]])]),t("div",Gt,[e[66]||(e[66]=t("label",{for:"productStock"},"Stock",-1)),n(t("input",{type:"number",id:"productStock","onUpdate:modelValue":e[17]||(e[17]=l=>a.value.stock=l),placeholder:"Stock"},null,512),[[p,a.value.stock]])]),t("div",Jt,[e[67]||(e[67]=t("label",{for:"productPrice"},"Price (Rp)",-1)),n(t("input",{type:"number",id:"productPrice","onUpdate:modelValue":e[18]||(e[18]=l=>a.value.price=l),placeholder:"Price"},null,512),[[p,a.value.price]])]),t("div",Wt,[e[69]||(e[69]=t("label",{for:"productCategory"},"Category",-1)),n(t("select",{id:"productCategory","onUpdate:modelValue":e[19]||(e[19]=l=>a.value.category=l)},e[68]||(e[68]=[t("option",{value:""},"Pilih Kategori",-1),t("option",{value:"Sembako"},"Sembako",-1),t("option",{value:"Makanan Instan & Siap Saji"},"Makanan Instan & Siap Saji",-1),t("option",{value:"Camilan & Snack"},"Camilan & Snack",-1),t("option",{value:"Minuman"},"Minuman",-1),t("option",{value:"Produk Susu"},"Produk Susu",-1),t("option",{value:"Bumbu Dapur"},"Bumbu Dapur",-1),t("option",{value:"Produk Beku & Dingin"},"Produk Beku & Dingin",-1),t("option",{value:"Rokok & Aksesoris"},"Rokok & Aksesoris",-1),t("option",{value:"Kebutuhan Kebersihan"},"Kebutuhan Kebersihan",-1),t("option",{value:"Lainnya"},"Lainnya",-1)]),512),[[y,a.value.category]])]),t("div",Qt,[e[71]||(e[71]=t("label",{for:"productStatus"},"Status",-1)),n(t("select",{id:"productStatus","onUpdate:modelValue":e[20]||(e[20]=l=>a.value.status=l)},e[70]||(e[70]=[t("option",{value:"Avail"},"Avail",-1),t("option",{value:"Out of Stock"},"Out of Stock",-1)]),512),[[y,a.value.status]])])]),t("div",Xt,[t("button",{class:"btn-cancel",onClick:e[21]||(e[21]=l=>M.value=!1)},"Batal"),t("button",{class:"btn-save",onClick:X},"Simpan")]),t("div",Yt,[e[73]||(e[73]=t("label",{for:"productUnit"},"Unit",-1)),n(t("select",{id:"productUnit","onUpdate:modelValue":e[22]||(e[22]=l=>a.value.unit=l)},e[72]||(e[72]=[t("option",{value:""},"Pilih Unit",-1),t("option",{value:"pcs"},"pcs",-1),t("option",{value:"box"},"box",-1),t("option",{value:"kg"},"kg",-1),t("option",{value:"liter"},"liter",-1),t("option",{value:"pack"},"pack",-1)]),512),[[y,a.value.unit]])])])])):g("",!0),S.value?(i(),d("div",Zt,[t("div",_t,[t("div",te,[e[74]||(e[74]=t("h3",null,"Edit Produk",-1)),t("button",{class:"close-btn",onClick:e[23]||(e[23]=l=>S.value=!1)},"Ã—")]),t("div",ee,[t("div",le,[e[75]||(e[75]=t("label",null,"Kode Produk",-1)),n(t("input",{type:"text","onUpdate:modelValue":e[24]||(e[24]=l=>s.value.code=l),disabled:""},null,512),[[p,s.value.code]])]),t("div",oe,[e[76]||(e[76]=t("label",null,"Nama Produk",-1)),n(t("input",{type:"text","onUpdate:modelValue":e[25]||(e[25]=l=>s.value.name=l),required:""},null,512),[[p,s.value.name]])]),t("div",ae,[e[77]||(e[77]=t("label",null,"Stok",-1)),n(t("input",{type:"number","onUpdate:modelValue":e[26]||(e[26]=l=>s.value.stock=l),required:""},null,512),[[p,s.value.stock]])]),t("div",se,[e[78]||(e[78]=t("label",null,"Harga Rata-rata",-1)),n(t("input",{type:"number","onUpdate:modelValue":e[27]||(e[27]=l=>s.value.average_price=l),required:""},null,512),[[p,s.value.average_price]])]),t("div",ne,[e[79]||(e[79]=t("label",null,"Harga Jual",-1)),n(t("input",{type:"number","onUpdate:modelValue":e[28]||(e[28]=l=>s.value.selling_price=l),required:""},null,512),[[p,s.value.selling_price]])]),t("div",ie,[e[81]||(e[81]=t("label",null,"Kategori",-1)),n(t("select",{"onUpdate:modelValue":e[29]||(e[29]=l=>s.value.category=l)},e[80]||(e[80]=[t("option",{value:""},"Pilih Kategori",-1),t("option",{value:"Sembako"},"Sembako",-1),t("option",{value:"Makanan Instan & Siap Saji"},"Makanan Instan & Siap Saji",-1),t("option",{value:"Camilan & Snack"},"Camilan & Snack",-1),t("option",{value:"Minuman"},"Minuman",-1),t("option",{value:"Produk Susu"},"Produk Susu",-1),t("option",{value:"Bumbu Dapur"},"Bumbu Dapur",-1),t("option",{value:"Produk Beku & Dingin"},"Produk Beku & Dingin",-1),t("option",{value:"Rokok & Aksesoris"},"Rokok & Aksesoris",-1),t("option",{value:"Kebutuhan Kebersihan"},"Kebutuhan Kebersihan",-1),t("option",{value:"Lainnya"},"Lainnya",-1)]),512),[[y,s.value.category]])]),t("div",ue,[e[83]||(e[83]=t("label",null,"Unit",-1)),n(t("select",{"onUpdate:modelValue":e[30]||(e[30]=l=>s.value.unit=l)},e[82]||(e[82]=[t("option",{value:""},"Pilih Unit",-1),t("option",{value:"pcs"},"pcs",-1),t("option",{value:"box"},"box",-1),t("option",{value:"kg"},"kg",-1),t("option",{value:"liter"},"liter",-1),t("option",{value:"pack"},"pack",-1)]),512),[[y,s.value.unit]])])]),t("div",re,[t("button",{class:"btn-cancel",onClick:e[31]||(e[31]=l=>S.value=!1)},"Batal"),t("button",{class:"btn-save",onClick:Y},"Simpan Perubahan")])])])):g("",!0)])])])])])])]),_:1})],64))}},ge=nt(de,[["__scopeId","data-v-377d18fb"]]);export{ge as default};
